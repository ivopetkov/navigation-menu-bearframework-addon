<?php

/*
 * Navigation menu addon for Bear Framework
 * https://github.com/ivopetkov/navigation-menu-bearframework-addon
 * Copyright (c) Ivo Petkov
 * Free to use under the MIT license.
 */

return <<<'EOT'
var ivoPetkov=ivoPetkov||{};ivoPetkov.bearFrameworkAddons=ivoPetkov.bearFrameworkAddons||{},ivoPetkov.bearFrameworkAddons.navigationMenu=ivoPetkov.bearFrameworkAddons.navigationMenu||{make:function(t,e,i){var n=document.getElementById(t),l=null,r=!1,o=null,a=function(){if(!r){var t=n.getBoundingClientRect(),a=n.getAttribute(e);null===a&&(a="none");var d=JSON.stringify([a,t.top,t.left,t.width,t.height]);if(o!==d){r=!0,n.style.overflow="hidden";var h=function(t,e){for(var i=e.childNodes,n=i.length,r=0;r<n;r++){var o=i[r];if(o.childNodes.length>1){var d=o.firstChild;"a"===d.tagName.toLowerCase()&&("none"===a?(void 0!==d.nmts&&delete d.nmts,void 0!==d.nmtsh&&(d.removeEventListener("touchstart",d.nmtsh),delete d.nmtsh)):void 0===d.nmtsh&&(d.nmtsh=function(t){var e=this.parentNode;void 0!==this.nmts?(e===l?e.lastChild.style.display="none":this.htmlnavth.length>0&&(this.href=this.htmlnavth),delete this.nmts):(e===l?e.lastChild.style.removeProperty("display"):(void 0===this.htmlnavth&&(this.htmlnavth=this.href),this.href="javascript:void(0);"),this.nmts=1)},d.addEventListener("touchstart",d.nmtsh,{passive:!0})));var s=o.lastChild;if("none"===a)s.style.removeProperty("left"),s.style.removeProperty("top");else{var v=document.body.clientWidth;s.style.left="-99999px",s.style.display="inline-block",s.style.maxWidth=v+"px";var f=o.getBoundingClientRect(),u=s.getBoundingClientRect(),g=0,c=0;"horizontal-down"===a?o===l?g-=u.width-f.width:g=t>0?f.width:0:"vertical-right"===a?g=f.width:"vertical-left"===a&&(g=-u.width);var m=!1,w=u.left+u.width+99999-v+g;w>0&&(g-=w,m=!0);var p=-(u.left+99999+g);p>0&&(g+=p,m=!0),m&&("horizontal-down"===a&&t>0||"vertical-right"===a||"vertical-left"===a)&&(c+=3*f.height/4),s.style.left=Math.floor(g)+"px",s.style.top=Math.floor(("horizontal-down"===a&&0===t?f.height:0)+c)+"px",h(t+1,s),s.style.removeProperty("display")}}}};if(null!==l)for(var s=0;s<99999;s++){var v=l.lastChild;if(null===v.firstChild)break;l.parentNode.appendChild(v.firstChild)}var f=!1;if("horizontal-down"===a){var u=n.lastChild;if(null!==l&&u===l&&(u=u.previousSibling),null!==u){var g=u.getBoundingClientRect();if(Math.ceil(g.left+g.width)>Math.ceil(t.left+t.width)){if(null===l){var c=document.createElement("div");c.innerHTML=i,l=c.firstChild,n.appendChild(l)}var m=n.childNodes,w=[],p=0;for(s=0;s<m.length;s++)if((k=m[s])!==l&&"always"===k.getAttribute("data-navigation-visible")){var y=k.getBoundingClientRect();w.push(k),p+=y.width}var b=l.getBoundingClientRect(),C=null;for(s=0;s<m.length;s++){var k;if((k=m[s])!==l&&"always"!==k.getAttribute("data-navigation-visible")&&(y=k.getBoundingClientRect(),Math.ceil(y.left+y.width+b.width)>Math.ceil(t.left+t.width-p))){C=m[s];break}}for(n.insertBefore(l,C),s=0;s<99999&&l.nextSibling;s++)if(-1!==w.indexOf(l.nextSibling)){var M=l.nextSibling;n.insertBefore(M,l)}else l.lastChild.appendChild(l.nextSibling);f=!0}}}f||null!==l&&(l.parentNode.removeChild(l),l=null),h(0,n),n.style.overflow="initial",o=d,r=!1}}};if(a(),"undefined"!=typeof MutationObserver){var d=null;new MutationObserver((function(){var t=n.getAttribute(e);t!==d&&(d=t,a())})).observe(n,{attributes:!0})}"undefined"!=typeof ResizeObserver&&new ResizeObserver(a).observe(n),window.addEventListener("resize",a),window.addEventListener("orientationchange",a)}};
EOT;
