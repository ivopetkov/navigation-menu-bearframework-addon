<?php

/*
 * Navigation menu addon for Bear Framework
 * https://github.com/ivopetkov/navigation-menu-bearframework-addon
 * Copyright (c) Ivo Petkov
 * Free to use under the MIT license.
 */

return <<<'EOT'
var ivoPetkov=ivoPetkov||{};ivoPetkov.bearFrameworkAddons=ivoPetkov.bearFrameworkAddons||{},ivoPetkov.bearFrameworkAddons.navigationMenu=ivoPetkov.bearFrameworkAddons.navigationMenu||{make:function(t,e,i){var n=document.getElementById(t),l=null,o=!1,r=null,a=function(){if(!o){var t=n.getBoundingClientRect(),a=n.getAttribute(e);null===a&&(a="none");var h=JSON.stringify([a,Math.floor(t.top),Math.floor(t.left),Math.floor(t.width),Math.floor(t.height)]);if(r!==h){o=!0,n.style.overflow="hidden";var d=function(t,e){for(var i=e.childNodes,n=i.length,o=0;o<n;o++){var r=i[o];if(r.childNodes.length>1){var h=r.firstChild;"a"===h.tagName.toLowerCase()&&("none"===a?(void 0!==h.nmts&&delete h.nmts,void 0!==h.nmtsh&&(h.removeEventListener("touchstart",h.nmtsh),delete h.nmtsh)):void 0===h.nmtsh&&(h.nmtsh=function(t){var e=this.parentNode;void 0!==this.nmts?(e===l?e.lastChild.style.display="none":this.htmlnavth.length>0&&(this.href=this.htmlnavth),delete this.nmts):(e===l?e.lastChild.style.removeProperty("display"):(void 0===this.htmlnavth&&(this.htmlnavth=this.href),this.href="javascript:void(0);"),this.nmts=1)},h.addEventListener("touchstart",h.nmtsh,{passive:!0})));var s=r.lastChild;if("none"===a)s.style.removeProperty("left"),s.style.removeProperty("top");else{var v=document.body.clientWidth;s.style.left="-99999px",s.style.display="inline-block",s.style.maxWidth=v+"px";var f=r.getBoundingClientRect(),u=s.getBoundingClientRect(),g=0,c=0;"horizontal-down"===a?r===l?g-=Math.floor(u.width-f.width):g=t>0?Math.floor(f.width):0:"vertical-right"===a?g=Math.floor(f.width):"vertical-left"===a&&(g=-Math.floor(u.width));var m=!1,w=Math.floor(u.left)+Math.floor(u.width)+99999-v+g;w>0&&(g-=w,m=!0);var p=-(Math.floor(u.left)+99999+g);p>0&&(g+=p,m=!0),m&&("horizontal-down"===a&&t>0||"vertical-right"===a||"vertical-left"===a)&&(c+=Math.floor(3*f.height/4)),s.style.left=Math.floor(g)+"px",s.style.top=Math.floor(("horizontal-down"===a&&0===t?Math.floor(f.height):0)+c)+"px",d(t+1,s),s.style.removeProperty("display")}}}};if(null!==l)for(var s=0;s<99999;s++){var v=l.lastChild;if(null===v.firstChild)break;l.parentNode.appendChild(v.firstChild)}var f=!1;if("horizontal-down"===a){var u=n.lastChild;if(null!==l&&u===l&&(u=u.previousSibling),null!==u){var g=u.getBoundingClientRect();if(Math.ceil(g.left+g.width)>Math.ceil(t.left+t.width)){if(null===l){var c=document.createElement("div");c.innerHTML=i,l=c.firstChild,n.appendChild(l)}var m=n.childNodes,w=[],p=0;for(s=0;s<m.length;s++)if((C=m[s])!==l&&"always"===C.getAttribute("data-navigation-visible")){var y=C.getBoundingClientRect();w.push(C),p+=Math.floor(y.width)}var b=l.getBoundingClientRect(),M=null;for(s=0;s<m.length;s++){var C;if((C=m[s])!==l&&"always"!==C.getAttribute("data-navigation-visible")&&(y=C.getBoundingClientRect(),Math.ceil(y.left+y.width+b.width)>Math.ceil(t.left+t.width-p))){M=m[s];break}}for(n.insertBefore(l,M),s=0;s<99999&&l.nextSibling;s++)if(-1!==w.indexOf(l.nextSibling)){var k=l.nextSibling;n.insertBefore(k,l)}else l.lastChild.appendChild(l.nextSibling);f=!0}}}f||null!==l&&(l.parentNode.removeChild(l),l=null),d(0,n),n.style.overflow="initial",r=h,o=!1}}};if(a(),"undefined"!=typeof MutationObserver){var h=null;new MutationObserver((function(){var t=n.getAttribute(e);t!==h&&(h=t,a())})).observe(n,{attributes:!0})}"undefined"!=typeof ResizeObserver&&new ResizeObserver(a).observe(n),window.addEventListener("resize",a),window.addEventListener("orientationchange",a)}};
EOT;
